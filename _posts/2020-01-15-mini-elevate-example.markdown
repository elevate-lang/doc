---
layout: post
title:  "Mini-Elevate Example"
date:   2020-02-11 12:30:00 +0000
---
$$\begin{align*}\\&\typeDef{\tsvar{Result}}{\forallType{\forallTypeWrap{\tvar{a}}\forallTypeSep\forallTypeWrap{\tvar{b}}}\variantType{\extendRow{\label{Success}}{\tvar{a}}{\extendRow{\label{Failure}}{\tvar{b}}{\emptyRow}}}}\\&\typeDef{\tsvar{Strategy}}{\forallRow{\forallRowWrap{\rvar{p}}\forallRowSep\forallRowWrap{\rvar{q}}}\funType{\variantType{\rvar{p}}}{\instType{\instType{\tsvar{Result}}{\variantType{\rvar{q}}}}{\tsvar{Nat}}}}\\&\funDef{\var{id}}{\instRow{\instRow{\tsvar{Strategy}}{\rvar{p}}}{\rvar{p}}}{\\&\quad\lamDef{\funDefArg{\var{x}}{\variantType{\rvar{p}}}\variantType{\extendRow{\label{Success}}{\variantType{\rvar{p}}}{\rvar{r}}}}{\app{\label{Success}}{\var{x}}}}\\&\funDef{\var{fail}}{\instRow{\instRow{\tsvar{Strategy}}{\rvar{p}}}{\rvar{r}}}{\\&\quad\lamDef{\funDefArg{\var{x}}{\variantType{\rvar{p}}}\variantType{\extendRow{\label{Failure}}{\tsvar{Nat}}{\rvar{u}}}}{\app{\label{Failure}}{\label{0}}}}\\&\funDef{\var{flatMap}}{\funDefArg{\var{x}}{\instType{\instType{\tsvar{Result}}{\tvar{a}}}{\tvar{b}}}\funDefArg{\var{f}}{\funType{\tvar{a}}{\instType{\instType{\tsvar{Result}}{\tvar{c}}}{\tvar{b}}}}\instType{\instType{\tsvar{Result}}{\tvar{c}}}{\tvar{b}}}{\\&\quad\match{\var{x}}{\\&\quad\quad\case{\patternAppPattern{\label{Success}}{\pvar{a}}}{\app{\var{f}}{\var{a}}}\\&\quad\matchSepBreak\case{\patternAppPattern{\label{Failure}}{\pvar{b}}}{\app{\label{Failure}}{\var{b}}}\\&\quad}}\\&\funDef{\var{seq}}{\funDefArg{\var{fs}}{\instRow{\instRow{\tsvar{Strategy}}{\rvar{p}}}{\rvar{q}}}\funDefArg{\var{ss}}{\instRow{\instRow{\tsvar{Strategy}}{\rvar{q}}}{\rvar{r}}}\instRow{\instRow{\tsvar{Strategy}}{\rvar{p}}}{\rvar{r}}}{\\&\quad\lamDef{\funDefArg{\var{x}}{\variantType{\rvar{p}}}\instType{\instType{\tsvar{Result}}{\variantType{\rvar{r}}}}{\tsvar{Nat}}}{\app{\app{\var{flatMap}}{(\app{\var{fs}}{\var{x}})}}{(\\&\quad\quad\lamDef{\funDefArg{\var{x}}{\variantType{\rvar{q}}}\instType{\instType{\tsvar{Result}}{\variantType{\rvar{r}}}}{\tsvar{Nat}}}{\app{\var{ss}}{\var{x}}}\\&\quad)}}}\\&\typeDef{\tsvar{Primitive}}{\forallRow{\forallRowWrap{\rvar{p}}}\variantType{\extendRow{\label{Map}}{\recordType{\emptyRow}}{\rvar{p}}}}\\&\typeDef{\tsvar{Type}}{\recVariantType{\tvar{t}}{\emptyRow}}\\&\typeDef{\tsvar{Expr}}{\forallRow{\forallRowWrap{\rvar{p}}}\recVariantType{\tvar{e}}{\extendRow{\label{Id}}{\recordType{\extendRow{\label{Name}}{\tsvar{Nat}}{\extendRow{\label{Type}}{\tsvar{Type}}{\emptyRow}}}}{\extendRow{\label{Lam}}{\recordType{\extendRow{\label{Param}}{\tsvar{Nat}}{\extendRow{\label{Body}}{\tvar{e}}{\extendRow{\label{Type}}{\tsvar{Type}}{\emptyRow}}}}}{\extendRow{\label{App}}{\recordType{\extendRow{\label{Fun}}{\tvar{e}}{\extendRow{\label{Arg}}{\tvar{e}}{\extendRow{\label{Type}}{\tsvar{Type}}{\emptyRow}}}}}{\extendRow{\label{Primitive}}{\instRow{\tsvar{Primitive}}{\rvar{p}}}{\emptyRow}}}}}}\var{\_}\end{align*}$$

$$\begin{align*}\\&\funDef{\var{fusion}}{\instRow{\instRow{\tsvar{Strategy}}{\extendRow{\label{App}}{\recordType{\extendRow{\label{Fun}}{\variantType{\extendRow{\label{App}}{\recordType{\extendRow{\label{Fun}}{\variantType{\extendRow{\label{Primitive}}{\variantType{\extendRow{\label{Map}}{\recordType{\emptyRow}}{\rvar{r6}}}}{\rvar{r5}}}}{\extendRow{\label{Arg}}{\tvar{f}}{\rvar{r4}}}}}{\rvar{r3}}}}{\extendRow{\label{Arg}}{\variantType{\extendRow{\label{App}}{\recordType{\extendRow{\label{Fun}}{\variantType{\extendRow{\label{App}}{\recordType{\extendRow{\label{Fun}}{\variantType{\extendRow{\label{Primitive}}{\variantType{\extendRow{\label{Map}}{\recordType{\emptyRow}}{\rvar{r12}}}}{\rvar{r11}}}}{\extendRow{\label{Arg}}{\tvar{g}}{\rvar{r10}}}}}{\rvar{r9}}}}{\extendRow{\label{Arg}}{\tvar{x}}{\rvar{r8}}}}}{\rvar{r7}}}}{\rvar{r1}}}}}{\rvar{r0}}}}{\extendRow{\label{App}}{\recordType{\extendRow{\label{Fun}}{\variantType{\extendRow{\label{App}}{\recordType{\extendRow{\label{Fun}}{\variantType{\extendRow{\label{Primitive}}{\variantType{\extendRow{\label{Map}}{\recordType{\emptyRow}}{\rvar{h5}}}}{\rvar{h4}}}}{\extendRow{\label{Arg}}{\variantType{\extendRow{\label{Lam}}{\recordType{\extendRow{\label{Param}}{\tsvar{Nat}}{\extendRow{\label{Body}}{\variantType{\extendRow{\label{App}}{\recordType{\extendRow{\label{Fun}}{\tvar{f}}{\extendRow{\label{Arg}}{\variantType{\extendRow{\label{App}}{\recordType{\extendRow{\label{Fun}}{\tvar{g}}{\extendRow{\label{Arg}}{\variantType{\extendRow{\label{Id}}{\recordType{\extendRow{\label{Name}}{\tsvar{Nat}}{\rvar{h13}}}}{\rvar{h12}}}}{\rvar{h11}}}}}{\rvar{h10}}}}{\rvar{h9}}}}}{\rvar{h8}}}}{\rvar{h7}}}}}{\rvar{h6}}}}{\rvar{h3}}}}}{\rvar{h2}}}}{\extendRow{\label{Arg}}{\tvar{x}}{\rvar{h1}}}}}{\rvar{h0}}}}{\\&\quad\lamDef{\funDefArg{\var{x}}{\variantType{\rvar{\_}}}\instType{\instType{\tsvar{Result}}{\variantType{\rvar{\_}}}}{\tsvar{Nat}}}{\\&\quad\quad\match{\var{x}}{\\&\quad\quad\quad\case{\patternAppRecord{\label{App}}{\labelPattern{\label{Fun}}{\patternAppRecord{\label{App}}{\labelPattern{\label{Fun}}{\patternAppPattern{\label{Primitive}}{\label{Map}}}\patternAppRecordSep\labelPattern{\label{Arg}}{\pvar{f}}}}\patternAppRecordSep\labelPattern{\label{Arg}}{\patternAppRecord{\label{App}}{\labelPattern{\label{Fun}}{\patternAppRecord{\label{App}}{\labelPattern{\label{Fun}}{\patternAppPattern{\label{Primitive}}{\label{Map}}}\patternAppRecordSep\labelPattern{\label{Arg}}{\pvar{g}}}}\patternAppRecordSep\labelPattern{\label{Arg}}{\pvar{x}}}}}}{\app{\label{Success}}{(\app{\label{App}}{\record{\\&\quad\quad\quad\quad\recordField{\label{Fun}}{\app{\label{App}}{\record{\\&\quad\quad\quad\quad\quad\recordField{\label{Fun}}{\app{\label{Primitive}}{\label{Map}}}\\&\quad\quad\quad\quad\recordSepBreak\recordField{\label{Arg}}{\app{\label{Lam}}{\record{\\&\quad\quad\quad\quad\quad\quad\recordField{\label{Param}}{\label{0}}\\&\quad\quad\quad\quad\quad\recordSepBreak\recordField{\label{Body}}{\app{\label{App}}{\record{\\&\quad\quad\quad\quad\quad\quad\quad\recordField{\label{Fun}}{\var{f}}\\&\quad\quad\quad\quad\quad\quad\recordSepBreak\recordField{\label{Arg}}{\app{\label{App}}{\record{\\&\quad\quad\quad\quad\quad\quad\quad\quad\recordField{\label{Fun}}{\var{g}}\\&\quad\quad\quad\quad\quad\quad\quad\recordSepBreak\recordField{\label{Arg}}{\app{\label{Id}}{\record{\recordField{\label{Name}}{\label{0}}}}}\\&\quad\quad\quad\quad\quad\quad\quad}}}\\&\quad\quad\quad\quad\quad\quad}}}\\&\quad\quad\quad\quad\quad}}}\\&\quad\quad\quad\quad}}}\\&\quad\quad\quad\recordSepBreak\recordField{\label{Arg}}{\var{x}}\\&\quad\quad\quad}})}}\\&\quad\quad\matchSepBreak\case{\pvar{\_}}{\app{\label{Failure}}{\label{1}}}\\&\quad\quad}}}\var{\_}\end{align*}$$